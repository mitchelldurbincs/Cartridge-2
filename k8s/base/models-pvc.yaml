# Shared PVC for model files
# Used by both actors (read) and trainer (write)
#
# NOTE: This uses ReadWriteMany which requires a storage class that supports it
# (NFS, EFS, Azure Files, GlusterFS, etc.). For single-node development,
# you can use ReadWriteOnce but only one pod can write at a time.
#
# For production with S3:
# - Trainer uploads models to S3 (MinIO)
# - Actors poll S3 for model updates
# - This PVC becomes unnecessary
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: models-shared
  namespace: cartridge
  labels:
    app.kubernetes.io/name: models
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: cartridge2
spec:
  # ReadWriteMany requires NFS/EFS/etc storage class
  # Change to ReadWriteOnce for single-node development
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 5Gi
  # Uncomment and set to your RWX-capable storage class
  # storageClassName: efs-sc
